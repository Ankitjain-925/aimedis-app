import { memberships } from "..\metaverse\avalon"

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema"]
}

model profiles {
  id                       String          @id @db.Uuid
  created_at               DateTime        @default(now()) @db.Timestamptz(6)
  updated_at               DateTime        @default(now()) @db.Timestamptz(6)
  username                 String?         @unique
  email                    String?
  phone                    String?
  gender                   gender?
  mrmrs                    String?
  title                    String?
  firstname                String?
  middlename               String?
  lastname                 String?
  position                 String?
  avatar_photo_url         String?
  avatar_rpm_photo_url     String?
  avatar_rpm_half_body_url String?
  avatar_rpm_full_body_url String?
  bio                      String?
  memberships              memberships[]
  notification_sent        notifications[] @relation("actor")
  notification_recieved    notifications[] @relation("recipients")

  @@schema("public")
}

enum gender {
  male
  female
  other

  @@schema("public")
}

model entities {
  id String   @id @db.Uuid
  app           app 
  trigger_point String
  notifications notifications[] 
  
  @@schema("public")
}

model notifications {
  id            String   @id @db.Uuid
  actor         profiles @relation("actor", fields: [actor_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  actor_id      String   @db.Uuid
  recipients    profiles[] @relation("recipients")
  recipient_ids String @db.Uuid
  entity_id     String @db.Uuid
  entities      entities @relation(fields: [entity_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  message       String
  is_read       Boolean  @default(false)
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt

  @@schema("public")
}

enum app {
  admin
  care
  chat
  dapp
  exchange
  fhir
  health
  home
  metaverse
  store
  web

  @@schema("public")
}


model invalidated_tokens  {
  id         Int      @id @default(autoincrement())
  token      String   @unique
  expire_at  DateTime @default(now())

  @@schema("public")

}



